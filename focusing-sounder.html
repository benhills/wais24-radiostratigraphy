

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Radar sounder focusing &#8212; Re&#39;focusing&#39; on Radiostratigraphy</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'focusing-sounder';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Multi-squinted sounder focusing" href="multisquint.html" />
    <link rel="prev" title="Conventional radar focusing" href="focusing-conventional.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="header.html">
  
  
  
  
  
    <p class="title logo__title">Re'focusing' on Radiostratigraphy</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="header.html">
                    Abstract
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="focusing-conventional.html">Conventional radar focusing</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Radar sounder focusing</a></li>
<li class="toctree-l1"><a class="reference internal" href="multisquint.html">Multi-squinted sounder focusing</a></li>
<li class="toctree-l1"><a class="reference internal" href="bibliography.html">References</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Ffocusing-sounder.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/focusing-sounder.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>

</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Radar sounder focusing</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <div class="admonition note">
<p class="admonition-title">Note</p>
<p>Readers who already have a background in SAR methods should skip forward to <a class="reference internal" href="multisquint.html"><span class="doc">Multi-squinted sounder focusing</span></a> where we outline our algorithm for dipping englacial layers.</p>
</div>
<section class="tex2jax_ignore mathjax_ignore" id="radar-sounder-focusing">
<h1>Radar sounder focusing<a class="headerlink" href="#radar-sounder-focusing" title="Permalink to this heading">#</a></h1>
<p>For radar “sounding”, the desired targets are below the surface, so waves propagate through two media, commonly air and ice (e.g., for glaciological sounding).
In this case, the range correction is complicated slightly by refraction at the air-ice interface (<a class="reference internal" href="#sar-geometry"><span class="std std-numref">Fig. 1</span></a>).</p>
<figure class="align-default" id="sar-geometry">
<a class="reference internal image-reference" href="_images/SAR_geometry.png"><img alt="_images/SAR_geometry.png" src="_images/SAR_geometry.png" style="height: 300px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 1 </span><span class="caption-text">Illustration of SAR geometry for wave propagation through two media and refraction at their interface.</span><a class="headerlink" href="#sar-geometry" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Now, add a range component to equation <a class="reference internal" href="focusing-conventional.html#equation-sar-range-standard">(1)</a>, the original for propagation through air and a second for ice,</p>
<div class="math notranslate nohighlight" id="equation-sar-range-raybend">
<span class="eqno">(5)<a class="headerlink" href="#equation-sar-range-raybend" title="Permalink to this equation">#</a></span>\[r = r_{air} + r_{ice} = \sqrt{h^2 + (x-s)^2} + n\sqrt{d^2 + s^2}\]</div>
<p>where <span class="math notranslate nohighlight">\(h\)</span>, the height of the instrument platform above the ice surface, and <span class="math notranslate nohighlight">\(d\)</span>, the depth of the target below the ice surface, are known and assumed to be fixed within a given synthetic aperture.
If the <span class="math notranslate nohighlight">\(h\)</span> is not fixed due to motion of the platform, it is assumed that motion can be compensated.
<span class="math notranslate nohighlight">\(n=\sqrt{\varepsilon_r}\)</span> is the refractive index, and <span class="math notranslate nohighlight">\(\varepsilon_r\)</span> the relative permittivity, of ice.
Following Heliere et al. <span id="id1">[<a class="reference internal" href="bibliography.html#id3" title="Florence Hélière, Chung-Chi Lin, Hugh Corr, and David Vaughan. Radio echo sounding of pine island glacier, west antarctica: aperture synthesis processing and analysis of feasibility from space. IEEE Transactions on Geoscience and Remote Sensing, 45(8):2573–2582, 2007.">HeliereLCV07</a>]</span>, we can solve for the along-track point of refraction at the ice surface, <span class="math notranslate nohighlight">\(s\)</span>.
To do so, we relate the propagation angles in the air, squint angle <span class="math notranslate nohighlight">\(\theta\)</span>, and ice, <span class="math notranslate nohighlight">\(\theta_{ice}\)</span>, through Snell’s law,</p>
<div class="math notranslate nohighlight" id="equation-snells-law">
<span class="eqno">(6)<a class="headerlink" href="#equation-snells-law" title="Permalink to this equation">#</a></span>\[\frac{\sin\theta_1}{\sin\theta_2} = \frac{n_2}{n_1}\]</div>
<p>In air, <span class="math notranslate nohighlight">\(n_1\approx1\)</span>, and equation <a class="reference internal" href="#equation-snells-law">(6)</a> reduces to</p>
<div class="math notranslate nohighlight" id="equation-snells-law-2">
<span class="eqno">(7)<a class="headerlink" href="#equation-snells-law-2" title="Permalink to this equation">#</a></span>\[\sin\theta = n\sin\theta_{ice}\]</div>
<p>now with the only <span class="math notranslate nohighlight">\(n\)</span> being that for the second medium (ice; <span class="math notranslate nohighlight">\(n\approx1.77\)</span>).
Then, based on the geometry in <a class="reference internal" href="#sar-geometry"><span class="std std-numref">Fig. 1</span></a>, we substitute distances into equation <a class="reference internal" href="#equation-snells-law-2">(7)</a></p>
<div class="math notranslate nohighlight" id="equation-snells-law-geometry">
<span class="eqno">(8)<a class="headerlink" href="#equation-snells-law-geometry" title="Permalink to this equation">#</a></span>\[\frac{x - s}{\sqrt{h^{2} + (x - s)^{2}}} = n\frac{s}{\sqrt{d^{2} + s^{2}}}\]</div>
<p>which can be rearranged to a quartic equation for <span class="math notranslate nohighlight">\(s\)</span>,</p>
<div class="math notranslate nohighlight" id="equation-quartic">
<span class="eqno">(9)<a class="headerlink" href="#equation-quartic" title="Permalink to this equation">#</a></span>\[(\varepsilon_r - 1)s^4 - 
2(\varepsilon_r - 1)xs^3 + 
\left [ (\varepsilon_r - 1) x^2 + \varepsilon_r h^{2} - d^2 \right ] s^2 +
2d^{2} xs - 
d^{2} x^{2} = 0\]</div>
<p>Equation <a class="reference internal" href="#equation-quartic">(9)</a> has four roots, the smallest of which is our geometric distance in the along-track direction between the target and the point of refraction. Taking that root for <span class="math notranslate nohighlight">\(s\)</span> and plugging into <a class="reference internal" href="#equation-sar-range-raybend">(5)</a>, we repeat the calculations from <a class="reference internal" href="focusing-conventional.html"><span class="doc">Conventional radar focusing</span></a> but for sounding through two media.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The code cells below use functions from external python scripts. See the github repository (<a class="reference external" href="https://github.com/benhills/wais24-radiostratigraphy">here</a>) to access those scripts.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">functions</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c1"># define the geometry</span>
<span class="n">c</span> <span class="o">=</span> <span class="mf">3e8</span>
<span class="n">t0</span> <span class="o">=</span> <span class="mf">4e-6</span>     <span class="c1"># range to target at closest approach (assume x0 is 0)</span>
<span class="n">h</span> <span class="o">=</span> <span class="mi">500</span> <span class="c1"># height above ice surface</span>
<span class="n">dx</span> <span class="o">=</span> <span class="mf">.1</span>        <span class="c1"># x step</span>
<span class="n">Xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">100.</span><span class="p">,</span><span class="mi">100</span><span class="o">+</span><span class="n">dx</span><span class="p">,</span><span class="n">dx</span><span class="p">)</span> <span class="c1"># along-track distances within the synthetic aperture</span>

<span class="c1"># for a given squint angle (theta) find the depth in ice </span>
<span class="c1"># and along-track distance (x0) from center of aperture to target</span>
<span class="n">theta_sq</span> <span class="o">=</span> <span class="mf">1e-10</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.</span> <span class="c1"># divide by zero gives an error so give a small number</span>
<span class="n">r0</span> <span class="o">=</span> <span class="n">t0</span><span class="o">*</span><span class="n">c</span>
<span class="c1"># range offset within aperture - air only so simple geometry</span>
<span class="n">R1_air</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">r0</span><span class="o">**</span><span class="mf">2.</span><span class="o">+</span><span class="n">Xs</span><span class="o">**</span><span class="mf">2.</span><span class="p">)</span> <span class="o">-</span> <span class="n">r0</span><span class="p">)</span><span class="o">/</span><span class="n">c</span>
<span class="c1"># range offset within aperture - with ice so ray bending</span>
<span class="n">R1_ice</span> <span class="o">=</span> <span class="n">sar_raybend</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">Xs</span><span class="p">,</span> <span class="n">theta_sq</span><span class="p">)</span>

<span class="c1"># again with non-zero squint</span>
<span class="n">theta_sq</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.</span>
<span class="c1"># range offset within aperture - air only so simple geometry</span>
<span class="n">x0</span> <span class="o">=</span> <span class="n">r0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta_sq</span><span class="p">)</span>   <span class="c1"># distance from center of aperture to closest approach</span>
<span class="n">h_air</span> <span class="o">=</span> <span class="n">r0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta_sq</span><span class="p">)</span>    <span class="c1"># vertical height above target at closest approach</span>
<span class="n">R2_air</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">h_air</span><span class="o">**</span><span class="mf">2.</span><span class="o">+</span><span class="p">(</span><span class="n">Xs</span><span class="o">-</span><span class="n">x0</span><span class="p">)</span><span class="o">**</span><span class="mf">2.</span><span class="p">)</span> <span class="o">-</span> <span class="n">h_air</span><span class="p">)</span><span class="o">/</span><span class="n">c</span>
<span class="c1"># range offset within aperture - with ice so ray bending</span>
<span class="n">d</span><span class="p">,</span> <span class="n">x0</span> <span class="o">=</span> <span class="n">get_depth_dist</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span><span class="n">h</span><span class="p">,</span><span class="n">theta_sq</span><span class="p">)</span>
<span class="n">R2_ice</span> <span class="o">=</span> <span class="n">sar_raybend</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">Xs</span><span class="p">,</span> <span class="n">theta_sq</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/benhills/Software/MyGitRepos/wais24-radiostratigraphy/functions.py:134: ComplexWarning: Casting complex values to real discards the imaginary part
  s[i] = roots[np.argmin(abs(roots))]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the range-offset function, now in time</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xs</span><span class="p">,</span><span class="n">R1_air</span><span class="o">*</span><span class="mf">1e6</span><span class="p">,</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Nadir Air Only&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xs</span><span class="p">,</span><span class="n">R1_ice</span><span class="o">*</span><span class="mf">1e6</span><span class="p">,</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Nadir Air/Ice&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xs</span><span class="p">,</span><span class="n">R2_air</span><span class="o">*</span><span class="mf">1e6</span><span class="p">,</span><span class="s1">&#39;indianred&#39;</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Squinted Air Only&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xs</span><span class="p">,</span><span class="n">R2_ice</span><span class="o">*</span><span class="mf">1e6</span><span class="p">,</span><span class="s1">&#39;indianred&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Squinted Air/Ice&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Along-track distance (m)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Range offset ($\mu$sec)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mf">.04</span><span class="p">,</span><span class="o">-</span><span class="mf">.01</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">Xs</span><span class="p">),</span><span class="nb">max</span><span class="p">(</span><span class="n">Xs</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d214afc9973a19cc34c10e2ee467bba0e2123aea9de7d888d30317381875a303.png" src="_images/d214afc9973a19cc34c10e2ee467bba0e2123aea9de7d888d30317381875a303.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate and plot the matched filter for no squint</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mf">2.5</span><span class="p">))</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">matched_filter</span><span class="p">(</span><span class="n">r2p</span><span class="p">(</span><span class="n">R1_air</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xs</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">C</span><span class="p">),</span><span class="s1">&#39;k--&#39;</span><span class="p">)</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">matched_filter</span><span class="p">(</span><span class="n">r2p</span><span class="p">(</span><span class="n">R1_ice</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xs</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">C</span><span class="p">),</span><span class="s1">&#39;k-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Along-track distance (m)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Reference waveform&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">Xs</span><span class="p">),</span><span class="nb">max</span><span class="p">(</span><span class="n">Xs</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/6d17d463a6e8de720fca8a76ebc53734e6f1eae6e9d6968ec047c97e12cf73aa.png" src="_images/6d17d463a6e8de720fca8a76ebc53734e6f1eae6e9d6968ec047c97e12cf73aa.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate and plot the matched filter with squint</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mf">2.5</span><span class="p">))</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">matched_filter</span><span class="p">(</span><span class="n">r2p</span><span class="p">(</span><span class="n">R2_air</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xs</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">C</span><span class="p">),</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;indianred&#39;</span><span class="p">)</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">matched_filter</span><span class="p">(</span><span class="n">r2p</span><span class="p">(</span><span class="n">R2_ice</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xs</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">C</span><span class="p">),</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;indianred&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Along-track distance (m)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Refeference waveform&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">Xs</span><span class="p">),</span><span class="nb">max</span><span class="p">(</span><span class="n">Xs</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/01970dbfa4a8c2aeac9439c0c9752f80b1c382534b93a4850e8070e4c7d7b04c.png" src="_images/01970dbfa4a8c2aeac9439c0c9752f80b1c382534b93a4850e8070e4c7d7b04c.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### instrument properties</span>
<span class="n">fc</span> <span class="o">=</span> <span class="mf">150e6</span> <span class="c1"># center frequency</span>
<span class="n">L_a</span> <span class="o">=</span> <span class="mf">7.5</span> <span class="c1"># antenna length</span>
<span class="n">theta_beam</span> <span class="o">=</span> <span class="mf">0.866</span> <span class="o">*</span> <span class="mf">3e8</span><span class="o">/</span><span class="p">(</span><span class="n">fc</span><span class="o">*</span><span class="n">L_a</span><span class="p">)</span> <span class="c1"># &quot;half-power beamwidth&quot; of the antenna with respect to its Length</span>

<span class="n">c</span> <span class="o">=</span> <span class="mf">3e8</span>
<span class="n">t0</span> <span class="o">=</span> <span class="mf">4e-6</span>
<span class="n">h</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">2e-8</span>
<span class="n">dx</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">theta_sq</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.</span>

<span class="n">Xs</span><span class="p">,</span> <span class="n">ind_start_max</span><span class="p">,</span> <span class="n">ind_end_max</span> <span class="o">=</span> <span class="n">sar_extent</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">theta_sq</span><span class="p">,</span> <span class="n">theta_beam</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="n">dx</span><span class="p">)</span>
<span class="k">if</span> <span class="n">ind_start_max</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">ind_start_max</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">Xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">max</span><span class="p">(</span><span class="n">Xs</span><span class="p">),</span><span class="n">dx</span><span class="p">)</span>
<span class="n">n_x_max</span> <span class="o">=</span> <span class="n">ind_end_max</span><span class="o">-</span><span class="n">ind_start_max</span>

<span class="n">C_ref_all</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">t0</span><span class="o">/</span><span class="n">dt</span><span class="p">),</span><span class="n">n_x_max</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span>
<span class="k">for</span> <span class="n">si</span><span class="p">,</span><span class="n">ti</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">t0</span><span class="p">,</span><span class="n">dt</span><span class="p">)):</span>
    <span class="c1"># get aperture extents</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">ind_start</span><span class="p">,</span> <span class="n">ind_end</span> <span class="o">=</span> <span class="n">sar_extent</span><span class="p">(</span><span class="n">ti</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">h</span><span class="p">,</span><span class="n">ti</span><span class="o">*</span><span class="n">c</span><span class="p">),</span> <span class="n">theta_sq</span><span class="p">,</span> <span class="n">theta_beam</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="n">dx</span><span class="p">)</span>

    <span class="c1"># now calculate the reference function placed consistently in the oversized array</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">sar_raybend</span><span class="p">(</span><span class="n">ti</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">h</span><span class="p">,</span><span class="n">ti</span><span class="o">*</span><span class="n">c</span><span class="p">),</span> <span class="n">x</span><span class="p">,</span> <span class="n">theta_sq</span><span class="p">)</span>
    <span class="n">C_ref</span> <span class="o">=</span> <span class="n">matched_filter</span><span class="p">(</span><span class="n">r2p</span><span class="p">(</span><span class="n">r</span><span class="p">))</span>

    <span class="n">C_ref_all</span><span class="p">[</span><span class="n">si</span><span class="p">,</span><span class="n">ind_start</span><span class="o">-</span><span class="n">ind_start_max</span><span class="p">:</span><span class="n">ind_end</span><span class="o">-</span><span class="n">ind_start_max</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">C_ref</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">Xs</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">t0</span><span class="p">,</span><span class="n">dt</span><span class="p">)</span><span class="o">*</span><span class="mf">1e6</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">C_ref_all</span><span class="p">),</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;twilight_shifted&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Reference waveform&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">t0</span><span class="o">*</span><span class="mf">1e6</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="n">c</span><span class="o">*</span><span class="mf">1e6</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Along-track Distance (m)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Range ($\mu$sec)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/068dee3a0fcc3ddb28c180489360ecbe1247a130c942585b0663d6a01773b208.png" src="_images/068dee3a0fcc3ddb28c180489360ecbe1247a130c942585b0663d6a01773b208.png" />
</div>
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="focusing-conventional.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Conventional radar focusing</p>
      </div>
    </a>
    <a class="right-next"
       href="multisquint.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Multi-squinted sounder focusing</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Benjamin Hills and coauthors
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>